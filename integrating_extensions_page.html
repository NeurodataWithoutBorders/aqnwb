<!-- HTML header for doxygen 1.14.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>aqnwb: Integrating NWB Extensions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">var page_layout=1;</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom-modern.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="side-nav" class="ui-resizable side-nav-resizable"><!-- do not remove this div, it is closed by doxygen! -->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="aqnwb-logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">aqnwb<span id="projectnumber">&#160;0.1.0</span>
   </div>
  </td>
 </tr>
   <tr><td colspan="2">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
</td></tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('integrating_extensions_page.html','',''); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search',true);
});
</script>
<div id="main-nav"></div>
<div id="container"><div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Integrating NWB Extensions </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1 class="doxsection"><a class="anchor" id="integrate_namespace"></a>
How to Integrate a New Namespace</h1>
<p>Integrating a new schema namespace with AqNWB (e.g., to support an extension to NWB) involves generating the necessary specification files and ensuring that the namespace is registered with the <a class="el" href="class_a_q_n_w_b_1_1_s_p_e_c_1_1_namespace_registry.html">NamespaceRegistry</a>. This process is simplified through the use of the <span class="tt">generate_spec_files.py</span> script.</p>
<ol type="1">
<li><b>Get the schema files</b>: Download or create the schema for the namespace in YAML format. <dl class="section note"><dt>Note</dt><dd>If you are creating a new extension, please see the <a href="https://nwb-overview.readthedocs.io/en/latest/extensions_tutorial/extensions_tutorial_home.html">NWB Extension Tutorial</a> for more information on how to create data schema for NWB.</dd></dl>
</li>
<li><b>Convert the schema files to C++</b>: Run the <span class="tt">resources/generate_spec_files.py</span> script on your schema files to generate the necessary C++ header files. This script processes the schema and creates the appropriate C++ header files that include the namespace definitions and registration. <dl class="section note"><dt>Note</dt><dd>To learn more about how to use the script and its parameters, you can view the help doc by running: <div class="fragment"><div class="line">python resources/generate_spec_files.py --help</div>
</div><!-- fragment --></dd></dl>
</li>
<li><b>Include the Generated Header Files</b>: In your C++ code that uses AqNWB, include the generated header files. The header files will automatically take care of registering the namespace with the <a class="el" href="class_a_q_n_w_b_1_1_s_p_e_c_1_1_namespace_registry.html">NamespaceRegistry</a> by calling the <a class="el" href="_namespace_registry_8hpp.html#a1c5029fd0dece582bd5ca5153644edb2">REGISTER_NAMESPACE</a> macro. Once the extension has been registered, <a class="el" href="class_a_q_n_w_b_1_1_n_w_b_1_1_n_w_b_file.html#a5fe5d0aba7a050db86d5caa5b8cf4a04">NWBFile::initialize</a> will automatically take care of caching your schema in the NWB file when creating a new file.</li>
<li><b>Implement appropriate RegisteredType classes</b>: Follow the tutorial on <a class="el" href="registered_type_page.html">Implementing a new Neurodata Type</a> to define appropriate interfaces for the <span class="tt">neurodata_type</span>s defined in your new namespace.</li>
</ol>
<h1 class="doxsection"><a class="anchor" id="namespace_registry"></a>
How the NamespaceRegistry Works</h1>
<p>The <a class="el" href="class_a_q_n_w_b_1_1_s_p_e_c_1_1_namespace_registry.html">NamespaceRegistry</a> is a singleton class that manages the registration and lookup of namespace information.</p>
<h2 class="doxsection"><a class="anchor" id="register_namespace"></a>
Registering a Namespace</h2>
<p>The <a class="el" href="_namespace_registry_8hpp.html#a1c5029fd0dece582bd5ca5153644edb2">REGISTER_NAMESPACE</a> macro is used to register a namespace with the <a class="el" href="class_a_q_n_w_b_1_1_s_p_e_c_1_1_namespace_registry.html">NamespaceRegistry</a>. This macro is typically placed in the generated header file for the namespace schema and ensures that the namespace is registered when the header file is included. For example: </p><div class="fragment"><div class="line"><a class="code hl_define" href="_namespace_registry_8hpp.html#a1c5029fd0dece582bd5ca5153644edb2">REGISTER_NAMESPACE</a>(<span class="stringliteral">&quot;your_namespace&quot;</span>, <span class="stringliteral">&quot;1.0.0&quot;</span>, specVariables);</div>
<div class="ttc" id="a_namespace_registry_8hpp_html_a1c5029fd0dece582bd5ca5153644edb2"><div class="ttname"><a href="_namespace_registry_8hpp.html#a1c5029fd0dece582bd5ca5153644edb2">REGISTER_NAMESPACE</a></div><div class="ttdeci">#define REGISTER_NAMESPACE(name, version, specVariables)</div><div class="ttdoc">Macro to register a namespace with the global registry.</div><div class="ttdef"><b>Definition</b> NamespaceRegistry.hpp:60</div></div>
</div><!-- fragment --><p> would register the namespace <span class="tt">your_namespace</span> with version <span class="tt">1.0.0</span> and the specified <span class="tt">specVariables</span>.</p>
<h2 class="doxsection"><a class="anchor" id="namespace_lookup"></a>
Looking up Namespaces</h2>
<p>To retrieve information about a registered namespace, we can use the <a class="el" href="class_a_q_n_w_b_1_1_s_p_e_c_1_1_namespace_registry.html#acd8db02533a181089950dad7a4feedd6">getNamespaceInfo</a> method. For example:</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> NamespaceInfo* info = NamespaceRegistry::instance().getNamespaceInfo(<span class="stringliteral">&quot;your_namespace&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span> (info) {</div>
<div class="line">    <span class="comment">// Use the namespace information</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>Alternatively, we can also use <a class="el" href="class_a_q_n_w_b_1_1_s_p_e_c_1_1_namespace_registry.html#aceded37c693bb2f6aa21a5945a13557c">getAllNamespaces</a> to get a reference to all registered namespaces. For example: </p><div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keyword">auto</span>&amp; allNamespaces = NamespaceRegistry::instance().getAllNamespaces();</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [name, info] : allNamespaces) {</div>
<div class="line">    <span class="comment">// Process each namespace</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>The returned <span class="tt">info</span> object is, in both cases, a <a class="el" href="struct_a_q_n_w_b_1_1_types_1_1_namespace_info.html">NamespaceInfo</a> struct with the name, version, and specVariables.</p>
<h1 class="doxsection"><a class="anchor" id="labmetadata_extension_demo"></a>
LabMetaData Extension Demo</h1>
<p>The following example illustrated the key steps to implement and use an extension to NWB via AqNWB. The complete sources for this demo are available as part of the <a href="https://github.com/NeurodataWithoutBorders/aqnwb">AqNWB GitHub repo</a> in the <span class="tt">demo/labmetadata_extension_demo</span> folder.</p>
<h2 class="doxsection"><a class="anchor" id="labmetadata_extension_schema"></a>
Step 1: Get the Schema of the Extension</h2>
<p>The demo uses the schema from <a href="https://github.com/NeurodataWithoutBorders/ndx-labmetadata-example/">ndx-labmetadata-example</a> as an example. For convenience, we copied the relevant schema files already to the <span class="tt">demo/labmetadata_extension_demo/spec</span> folder.</p>
<h2 class="doxsection"><a class="anchor" id="labmetadata_extension_cpp_generation"></a>
Step 2: Convert the Schema to C++</h2>
<p>The schema files are converted to C++ using the <span class="tt">resources/generate_spec_files.py</span> script:</p>
<div class="fragment"><div class="line">mkdir demo/labmetadata_extension_demo/src</div>
<div class="line">python resources/generate_spec_files.py demo/labmetadata_extension_demo/spec demo/labmetadata_extension_demo/src</div>
</div><!-- fragment --><p>This generates the following new header file in the <span class="tt">demo/labmetadata_extension_demo/src</span> folder:</p>
<p><em>ndx_labmetadata_example.hpp</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#pragma once</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string_view&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_namespace_registry_8hpp.html">spec/NamespaceRegistry.hpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span>AQNWB::SPEC::NDX_LABMETADATA_EXAMPLE</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> std::string  namespaceName = <span class="stringliteral">&quot;ndx-labmetadata-example&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> std::string version = <span class="stringliteral">&quot;0.1.0&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">constexpr</span> std::string_view ndx_labmetadata_example_extensions = R<span class="stringliteral">&quot;delimiter(</span></div>
<div class="line"><span class="stringliteral">{&quot;groups&quot;:[{&quot;neurodata_type_def&quot;:&quot;LabMetaDataExtensionExample&quot;,&quot;neurodata_type_inc&quot;:&quot;LabMetaData&quot;,&quot;name&quot;:&quot;custom_lab_metadata&quot;,&quot;doc&quot;:&quot;Example extension type for storing lab metadata&quot;,&quot;datasets&quot;:[{&quot;name&quot;:&quot;tissue_preparation&quot;,&quot;dtype&quot;:&quot;text&quot;,&quot;doc&quot;:&quot;Lab-specific description of the preparation of the tissue&quot;,&quot;quantity&quot;:&quot;?&quot;}]}]})delimiter&quot;;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span><span class="keyword">constexpr</span> std::string_view namespaces = R<span class="stringliteral">&quot;delimiter(</span></div>
<div class="line"><span class="stringliteral">{&quot;namespaces&quot;:[{&quot;author&quot;:[&quot;Oliver Ruebel&quot;],&quot;contact&quot;:[&quot;oruebel@lbl.gov&quot;],&quot;doc&quot;:&quot; Example extension to illustrate how to extend LabMetaData for adding lab-specific metadata&quot;,&quot;name&quot;:&quot;ndx-labmetadata-example&quot;,&quot;schema&quot;:[{&quot;namespace&quot;:&quot;core&quot;,&quot;neurodata_types&quot;:[&quot;LabMetaData&quot;]},{&quot;source&quot;:&quot;ndx-labmetadata-example.extensions.yaml&quot;}],&quot;version&quot;:&quot;0.1.0&quot;}]})delimiter&quot;;</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral"></span><span class="keyword">const</span> std::vector&lt;std::pair&lt;std::string_view, std::string_view&gt;&gt;</div>
<div class="line">    specVariables {{</div>
<div class="line">  {<span class="stringliteral">&quot;ndx-labmetadata-example.extensions&quot;</span>, ndx_labmetadata_example_extensions},</div>
<div class="line">  {<span class="stringliteral">&quot;namespace&quot;</span>, namespaces}</div>
<div class="line"> </div>
<div class="line">}};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Register this namespace with the global registry</span></div>
<div class="line"><a class="code hl_define" href="_namespace_registry_8hpp.html#a1c5029fd0dece582bd5ca5153644edb2">REGISTER_NAMESPACE</a>(namespaceName, version, specVariables)</div>
<div class="line"> </div>
<div class="line">}  <span class="comment">// namespace AQNWB::SPEC::NDX_LABMETADATA_EXAMPLE</span></div>
<div class="ttc" id="a_namespace_registry_8hpp_html"><div class="ttname"><a href="_namespace_registry_8hpp.html">NamespaceRegistry.hpp</a></div></div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="labmetadata_extension_registered_type"></a>
Step 3: Create RegisteredType Classes for all neurodata_types</h2>
<p>Next, a <a class="el" href="class_a_q_n_w_b_1_1_n_w_b_1_1_registered_type.html">RegisteredType</a> class is implemented for the <span class="tt">LabMetaDataExtensionExample</span> neurodata_type defined in the schema. Please see the <a class="el" href="registered_type_page.html">Implementing a new Neurodata Type</a> tutorial for more details.</p>
<p><em>LabMetaDataExtensionExample.hpp</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#pragma once</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_container_8hpp.html">nwb/hdmf/base/Container.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;ndx_labmetadata_example.hpp&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>LabMetaDataExtensionExample : <span class="keyword">public</span> <a class="code hl_class" href="class_a_q_n_w_b_1_1_n_w_b_1_1_container.html">AQNWB::NWB::Container</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Constructor with path and io inputs required by RegisteredType</span></div>
<div class="line">    LabMetaDataExtensionExample(</div>
<div class="line">        <span class="keyword">const</span> std::string&amp; path, </div>
<div class="line">        std::shared_ptr&lt;AQNWB::IO::BaseIO&gt; io);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Method for initializing and writing the data in the NWB file</span></div>
<div class="line">    <a class="code hl_typedef" href="_base_i_o_8hpp.html#a38fce1d86c801b13b6860d3346276776">Status</a> <a class="code hl_function" href="class_a_q_n_w_b_1_1_n_w_b_1_1_container.html#a420424e52795b5212d7dcb728396af6a">initialize</a>(<span class="keyword">const</span> std::string&amp; tissuePreparation);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Define methods for reading custom extension fields</span></div>
<div class="line">    <a class="code hl_define" href="_registered_type_8hpp.html#acd3c876a1c357333cd4a8ff27300ee08">DEFINE_FIELD</a>(</div>
<div class="line">        readTissuePreparation, </div>
<div class="line">        <a class="code hl_variable" href="namespace_a_q_n_w_b_1_1_n_w_b.html#acfd896b65a7f56c25b3730a6e8dc80ca">AQNWB::NWB::DatasetField</a>, </div>
<div class="line">        std::string, </div>
<div class="line">        <span class="stringliteral">&quot;tissue_preparation&quot;</span>, </div>
<div class="line">        Lab-specific description of the preparation of the tissue)</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Register the class with the type registry</span></div>
<div class="line">    <a class="code hl_define" href="_registered_type_8hpp.html#a9c1f79aa46baaf33d1bf885cf7484aa1">REGISTER_SUBCLASS</a>(</div>
<div class="line">        LabMetaDataExtensionExample, </div>
<div class="line">        AQNWB::SPEC::NDX_LABMETADATA_EXAMPLE::namespaceName)</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    <span class="comment">// LabMetaData objects are stored in the NWB file at this location</span></div>
<div class="line">    <span class="keyword">const</span> std::string m_nwbBasePath = <span class="stringliteral">&quot;/general&quot;</span>;</div>
<div class="line">};</div>
<div class="ttc" id="a_base_i_o_8hpp_html_a38fce1d86c801b13b6860d3346276776"><div class="ttname"><a href="_base_i_o_8hpp.html#a38fce1d86c801b13b6860d3346276776">Status</a></div><div class="ttdeci">AQNWB::Types::Status Status</div><div class="ttdef"><b>Definition</b> BaseIO.hpp:22</div></div>
<div class="ttc" id="a_container_8hpp_html"><div class="ttname"><a href="_container_8hpp.html">Container.hpp</a></div></div>
<div class="ttc" id="a_registered_type_8hpp_html_a9c1f79aa46baaf33d1bf885cf7484aa1"><div class="ttname"><a href="_registered_type_8hpp.html#a9c1f79aa46baaf33d1bf885cf7484aa1">REGISTER_SUBCLASS</a></div><div class="ttdeci">#define REGISTER_SUBCLASS(T, NAMESPACE)</div><div class="ttdoc">Macro to register a subclass with the RegisteredType class registry.</div><div class="ttdef"><b>Definition</b> RegisteredType.hpp:377</div></div>
<div class="ttc" id="a_registered_type_8hpp_html_acd3c876a1c357333cd4a8ff27300ee08"><div class="ttname"><a href="_registered_type_8hpp.html#acd3c876a1c357333cd4a8ff27300ee08">DEFINE_FIELD</a></div><div class="ttdeci">#define DEFINE_FIELD(name, storageObjectType, default_type, fieldPath, description)</div><div class="ttdoc">Defines a lazy-loaded field accessor function.</div><div class="ttdef"><b>Definition</b> RegisteredType.hpp:411</div></div>
<div class="ttc" id="aclass_a_q_n_w_b_1_1_n_w_b_1_1_container_html"><div class="ttname"><a href="class_a_q_n_w_b_1_1_n_w_b_1_1_container.html">AQNWB::NWB::Container</a></div><div class="ttdoc">Abstract data type for a group storing collections of data and metadata.</div><div class="ttdef"><b>Definition</b> Container.hpp:17</div></div>
<div class="ttc" id="aclass_a_q_n_w_b_1_1_n_w_b_1_1_container_html_a420424e52795b5212d7dcb728396af6a"><div class="ttname"><a href="class_a_q_n_w_b_1_1_n_w_b_1_1_container.html#a420424e52795b5212d7dcb728396af6a">AQNWB::NWB::Container::initialize</a></div><div class="ttdeci">Status initialize()</div><div class="ttdoc">Initialize the container.</div><div class="ttdef"><b>Definition</b> Container.cpp:20</div></div>
<div class="ttc" id="anamespace_a_q_n_w_b_1_1_n_w_b_html_acfd896b65a7f56c25b3730a6e8dc80ca"><div class="ttname"><a href="namespace_a_q_n_w_b_1_1_n_w_b.html#acfd896b65a7f56c25b3730a6e8dc80ca">AQNWB::NWB::DatasetField</a></div><div class="ttdeci">constexpr auto DatasetField</div><div class="ttdoc">Alias for AQNWB::Types::StorageObjectType::Dataset.</div><div class="ttdef"><b>Definition</b> RegisteredType.hpp:28</div></div>
</div><!-- fragment --><p><em>LabMetaDataExtensionExample.cpp</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;LabMetaDataExtensionExample.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_utils_8hpp.html">Utils.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_a_q_n_w_b_1_1_n_w_b.html">AQNWB::NWB</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Initialize the static registered_ member to trigger registration</span></div>
<div class="line"><a class="code hl_define" href="_registered_type_8hpp.html#a54ea7671d2bcf5bae392b8ba1824961e">REGISTER_SUBCLASS_IMPL</a>(LabMetaDataExtensionExample)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">LabMetaDataExtensionExample::LabMetaDataExtensionExample(</div>
<div class="line">    <span class="keyword">const</span> std::string&amp; path,</div>
<div class="line">    std::shared_ptr&lt;AQNWB::IO::BaseIO&gt; io)</div>
<div class="line">    : <a class="code hl_namespace" href="namespace_a_q_n_w_b.html">AQNWB</a>::<a class="code hl_namespace" href="namespace_a_q_n_w_b_1_1_n_w_b.html">NWB</a>::<a class="code hl_class" href="class_a_q_n_w_b_1_1_n_w_b_1_1_container.html">Container</a>(path, io)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Check that our path points to expected location in the NWB file</span></div>
<div class="line">    <span class="keywordflow">if</span> (path.find(m_nwbBasePath) != 0) {</div>
<div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;LabMetaData path expected to appear in &quot;</span></div>
<div class="line">                  &lt;&lt; m_nwbBasePath &lt;&lt;  <span class="stringliteral">&quot; in the NWB file&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code hl_typedef" href="_base_i_o_8hpp.html#a38fce1d86c801b13b6860d3346276776">Status</a> LabMetaDataExtensionExample::initialize(<span class="keyword">const</span> std::string&amp; tissuePreparation)</div>
<div class="line">{</div>
<div class="line">  <a class="code hl_typedef" href="_base_i_o_8hpp.html#a38fce1d86c801b13b6860d3346276776">Status</a> containerStatus = <a class="code hl_function" href="class_a_q_n_w_b_1_1_n_w_b_1_1_container.html#a420424e52795b5212d7dcb728396af6a">Container::initialize</a>();</div>
<div class="line">  <span class="keyword">auto</span> tissuePrepPath = <a class="code hl_function" href="namespace_a_q_n_w_b.html#a31983dbaaa85c2e355b9687fc0ef1881">AQNWB::mergePaths</a>(m_path, <span class="stringliteral">&quot;tissue_preparation&quot;</span>);</div>
<div class="line">  <a class="code hl_typedef" href="_base_i_o_8hpp.html#a38fce1d86c801b13b6860d3346276776">Status</a> tissueDataStatus = m_io-&gt;createStringDataSet(tissuePrepPath, tissuePreparation);</div>
<div class="line">  <span class="keywordflow">return</span> containerStatus &amp;&amp; tissueDataStatus;</div>
<div class="line">}</div>
<div class="ttc" id="a_registered_type_8hpp_html_a54ea7671d2bcf5bae392b8ba1824961e"><div class="ttname"><a href="_registered_type_8hpp.html#a54ea7671d2bcf5bae392b8ba1824961e">REGISTER_SUBCLASS_IMPL</a></div><div class="ttdeci">#define REGISTER_SUBCLASS_IMPL(T)</div><div class="ttdoc">Macro to initialize the static member registered_ to trigger registration.</div><div class="ttdef"><b>Definition</b> RegisteredType.hpp:389</div></div>
<div class="ttc" id="a_utils_8hpp_html"><div class="ttname"><a href="_utils_8hpp.html">Utils.hpp</a></div></div>
<div class="ttc" id="anamespace_a_q_n_w_b_1_1_n_w_b_html"><div class="ttname"><a href="namespace_a_q_n_w_b_1_1_n_w_b.html">AQNWB::NWB</a></div><div class="ttdoc">Namespace for all classes related to the NWB data standard.</div><div class="ttdef"><b>Definition</b> TimeSeries.hpp:13</div></div>
<div class="ttc" id="anamespace_a_q_n_w_b_html"><div class="ttname"><a href="namespace_a_q_n_w_b.html">AQNWB</a></div><div class="ttdoc">The main namespace for AqNWB.</div><div class="ttdef"><b>Definition</b> Channel.hpp:11</div></div>
<div class="ttc" id="anamespace_a_q_n_w_b_html_a31983dbaaa85c2e355b9687fc0ef1881"><div class="ttname"><a href="namespace_a_q_n_w_b.html#a31983dbaaa85c2e355b9687fc0ef1881">AQNWB::mergePaths</a></div><div class="ttdeci">static std::string mergePaths(const std::string &amp;path1, const std::string &amp;path2)</div><div class="ttdoc">Merge two paths into a single path, handling extra trailing and starting &quot;/&quot;.</div><div class="ttdef"><b>Definition</b> Utils.hpp:112</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>As also discussed in more detail in the <a class="el" href="registered_type_page.html">Implementing a new Neurodata Type</a> tutorial, a few key points to note when implementing our derived <a class="el" href="class_a_q_n_w_b_1_1_n_w_b_1_1_registered_type.html">RegisteredType</a> class:<ol type="1">
<li><b>Selecting the base class</b>:<ul>
<li>At the very least our class must inherit from <a class="el" href="class_a_q_n_w_b_1_1_n_w_b_1_1_registered_type.html">RegisteredType</a></li>
<li>When the <span class="tt">neurodata_type</span> is a dataset then it is often useful to inherit from <a class="el" href="class_a_q_n_w_b_1_1_n_w_b_1_1_data.html">Data</a> to inherit its base <span class="tt">initialize</span> and read methods.</li>
<li>When a <span class="tt">neurodata_type</span> is a group then it is often useful to inherit from <a class="el" href="class_a_q_n_w_b_1_1_n_w_b_1_1_container.html">Container</a> to inherit its base <span class="tt">initialize</span> and read methods (this is what we use here)</li>
<li>Always inherit from the closest parent if possible. <b>Note:</b> Technically we also should have here created a class for <span class="tt">LabMetaData</span> itself and then inherited from it. However since <span class="tt">LabMetaData</span> is only an empty group and does not add any fields or features, we can just use <a class="el" href="class_a_q_n_w_b_1_1_n_w_b_1_1_container.html">Container</a> as our base class instead. The key purpose of the <span class="tt">LabMetaData</span> type is that it has a reserved space in the <span class="tt">/general</span> group in the NWB file.</li>
</ul>
</li>
<li><b>Ensure the registration macros are called</b>: These macros ensure that the class is registered with the <a class="el" href="class_a_q_n_w_b_1_1_n_w_b_1_1_registered_type.html">RegisteredType</a> type registry.<ul>
<li><a class="el" href="_registered_type_8hpp.html#a9c1f79aa46baaf33d1bf885cf7484aa1">REGISTER_SUBCLASS</a> must appear in the header file</li>
<li><a class="el" href="_registered_type_8hpp.html#a54ea7671d2bcf5bae392b8ba1824961e">REGISTER_SUBCLASS_IMPL</a> must appear in the cpp file</li>
</ul>
</li>
<li><b>Field Definitions</b>: The <a class="el" href="_registered_type_8hpp.html#acd3c876a1c357333cd4a8ff27300ee08">DEFINE_FIELD</a> and <a class="el" href="_registered_type_8hpp.html#af374245a4f6d5a00540e9fdba52a652a">DEFINE_REGISTERED_FIELD</a> macros simplify reading known fields from the file.</li>
<li><b>Schema Registration</b>: The generated header file automatically registers the namespace with the <a class="el" href="class_a_q_n_w_b_1_1_s_p_e_c_1_1_namespace_registry.html">NamespaceRegistry</a> using the <a class="el" href="_namespace_registry_8hpp.html#a1c5029fd0dece582bd5ca5153644edb2">REGISTER_NAMESPACE</a> macro. This ensures that as soon as we include the header in our app that the schema will be cached in the NWB file.</li>
</ol>
</dd></dl>
<h2 class="doxsection"><a class="anchor" id="labmetadata_extension_usage"></a>
Step 4: Using the Extension</h2>
<p>Finally, we can use our extension with AqNWB like any other type. The following example app illustrates how we can use our extension for writing and reading data with the new <span class="tt">LabMetaDataExtensionExample</span> type:</p>
<p><em>main.cpp</em> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;LabMetaDataExtensionExample.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_n_w_b_file_8hpp.html">nwb/NWBFile.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_h_d_f5_i_o_8hpp.html">io/hdf5/HDF5IO.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_utils_8hpp.html">Utils.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// The main routine implementing the main workflow of this demo application</span></div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Create the HDF5 I/O object for write</span></div>
<div class="line">    std::string filePath = <span class="stringliteral">&quot;testLabMetaDataExtensionExample.nwb&quot;</span>;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Print progress status</span></div>
<div class="line">    std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;Opening NWB file: &quot;</span> &lt;&lt; filePath &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create an IO object for writing the NWB file</span></div>
<div class="line">    <span class="keyword">auto</span> io = <a class="code hl_function" href="namespace_a_q_n_w_b.html#aae4545d930db6f70b4438e0167c500d0">AQNWB::createIO</a>(<span class="stringliteral">&quot;HDF5&quot;</span>, filePath);</div>
<div class="line">    io-&gt;open(<a class="code hl_enumvalue" href="namespace_a_q_n_w_b_1_1_i_o.html#a969d0800c8e9e2141f272541b85e8bedada364eb37e143f6b2b5559aa03f5913a">AQNWB::IO::FileMode::Overwrite</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create the NWBFile</span></div>
<div class="line">    <span class="keyword">auto</span> nwbfile = <a class="code hl_class" href="class_a_q_n_w_b_1_1_n_w_b_1_1_n_w_b_file.html">AQNWB::NWB::NWBFile</a>(io);</div>
<div class="line">    nwbfile.initialize(<span class="stringliteral">&quot;test_identifier&quot;</span>, <span class="stringliteral">&quot;Test NWB File&quot;</span>, <span class="stringliteral">&quot;Data collection info&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create the LabMetaDataExtensionExample object</span></div>
<div class="line">    std::string labMetaDataPath = <a class="code hl_function" href="namespace_a_q_n_w_b.html#a31983dbaaa85c2e355b9687fc0ef1881">AQNWB::mergePaths</a>(<span class="stringliteral">&quot;/general&quot;</span>, <span class="stringliteral">&quot;custom_lab_metadata&quot;</span>);</div>
<div class="line">    <span class="keyword">auto</span> labMetaData = LabMetaDataExtensionExample(labMetaDataPath, io);</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Writing &quot;</span>&lt;&lt; labMetaData.getPath() &lt;&lt; <span class="stringliteral">&quot; extension data&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    labMetaData.initialize(<span class="stringliteral">&quot;Tissue preparation details&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Close the file</span></div>
<div class="line">    io-&gt;close();</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Finished data write. Starting read.&quot;</span> &lt;&lt;std::endl;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create a new HDF5 I/O object for read</span></div>
<div class="line">    <span class="keyword">auto</span> readIO = <a class="code hl_function" href="namespace_a_q_n_w_b.html#aae4545d930db6f70b4438e0167c500d0">AQNWB::createIO</a>(<span class="stringliteral">&quot;HDF5&quot;</span>, filePath);</div>
<div class="line">    readIO-&gt;open(<a class="code hl_enumvalue" href="namespace_a_q_n_w_b_1_1_i_o.html#a969d0800c8e9e2141f272541b85e8beda131fb182a881796e7606ed6da27f1197">AQNWB::IO::FileMode::ReadOnly</a>);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Read the LabMetaDataExtensionExample object from the file</span></div>
<div class="line">    <span class="keyword">auto</span> readLabMetaData = LabMetaDataExtensionExample(labMetaDataPath, readIO);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Read the LabMetaDataExtensionExample.readTissuePreparation field</span></div>
<div class="line">    <span class="keyword">auto</span> tissuePreparationWrapper = readLabMetaData.readTissuePreparation();</div>
<div class="line">    std::string tissuePreparation = tissuePreparationWrapper-&gt;values().data[0];</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Read Tissue Preparation: &quot;</span> &lt;&lt; tissuePreparation &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Close the read file</span></div>
<div class="line">    readIO-&gt;close();</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="a_h_d_f5_i_o_8hpp_html"><div class="ttname"><a href="_h_d_f5_i_o_8hpp.html">HDF5IO.hpp</a></div></div>
<div class="ttc" id="a_n_w_b_file_8hpp_html"><div class="ttname"><a href="_n_w_b_file_8hpp.html">NWBFile.hpp</a></div></div>
<div class="ttc" id="aclass_a_q_n_w_b_1_1_n_w_b_1_1_n_w_b_file_html"><div class="ttname"><a href="class_a_q_n_w_b_1_1_n_w_b_1_1_n_w_b_file.html">AQNWB::NWB::NWBFile</a></div><div class="ttdoc">The NWBFile class provides an interface for setting up and managing the NWB file.</div><div class="ttdef"><b>Definition</b> NWBFile.hpp:32</div></div>
<div class="ttc" id="anamespace_a_q_n_w_b_1_1_i_o_html_a969d0800c8e9e2141f272541b85e8beda131fb182a881796e7606ed6da27f1197"><div class="ttname"><a href="namespace_a_q_n_w_b_1_1_i_o.html#a969d0800c8e9e2141f272541b85e8beda131fb182a881796e7606ed6da27f1197">AQNWB::IO::FileMode::ReadOnly</a></div><div class="ttdeci">@ ReadOnly</div><div class="ttdoc">Opens the file in read only mode.</div><div class="ttdef"><b>Definition</b> BaseIO.hpp:188</div></div>
<div class="ttc" id="anamespace_a_q_n_w_b_1_1_i_o_html_a969d0800c8e9e2141f272541b85e8bedada364eb37e143f6b2b5559aa03f5913a"><div class="ttname"><a href="namespace_a_q_n_w_b_1_1_i_o.html#a969d0800c8e9e2141f272541b85e8bedada364eb37e143f6b2b5559aa03f5913a">AQNWB::IO::FileMode::Overwrite</a></div><div class="ttdeci">@ Overwrite</div><div class="ttdoc">Opens the file and overwrites any existing file.</div><div class="ttdef"><b>Definition</b> BaseIO.hpp:172</div></div>
<div class="ttc" id="anamespace_a_q_n_w_b_html_aae4545d930db6f70b4438e0167c500d0"><div class="ttname"><a href="namespace_a_q_n_w_b.html#aae4545d930db6f70b4438e0167c500d0">AQNWB::createIO</a></div><div class="ttdeci">static std::shared_ptr&lt; IO::BaseIO &gt; createIO(const std::string &amp;type, const std::string &amp;filename)</div><div class="ttdoc">Factory method to create an IO object.</div><div class="ttdef"><b>Definition</b> Utils.hpp:89</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="devdocs.html">For Developers</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
